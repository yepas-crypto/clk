<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Flip Clock</title>
  <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #000; /* 예시처럼 검은 배경 */
      font-family: "Courier New", Courier, monospace;
    }

    .widget {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }

    .label {
      font-size: 12px;
      color: rgba(178,180,184,0.8);
      font-weight: bold;
      letter-spacing: 1px;
    }

    .clock {
      display: flex;
      gap: 8px;
    }

    .digit {
      position: relative;
      width: 120px;
      height: 160px;
      perspective: 1000px;
    }

    .upper,
    .lower,
    .flip-upper,
    .flip-lower {
      position: absolute;
      left: 0;
      width: 100%;
      height: 50%;
      overflow: hidden;
      background: #111;
      color: #aaa;
      font-size: 120px;
      font-weight: bold;
      display: flex;
      justify-content: center;
      align-items: center;
      line-height: 1;
    }

    .upper {
      top: 0;
      border-bottom: 1px solid #000;
      z-index: 2;
    }

    .lower {
      bottom: 0;
      border-top: 1px solid #000;
    }

    .flip-upper {
      top: 0;
      transform-origin: bottom;
      z-index: 3;
    }

    .flip-lower {
      bottom: 0;
      transform-origin: top;
      transform: rotateX(180deg);
      z-index: 1;
    }

    .digit.flip .flip-upper {
      animation: flipUpper 0.5s forwards;
    }

    .digit.flip .flip-lower {
      animation: flipLower 0.5s forwards;
    }

    @keyframes flipUpper {
      0% { transform: rotateX(0deg); }
      100% { transform: rotateX(-180deg); }
    }

    @keyframes flipLower {
      0% { transform: rotateX(180deg); }
      100% { transform: rotateX(0deg); }
    }
  </style>
</head>
<body>
  <div class="widget">
    <div class="label">InBody</div>
    <div class="clock" id="clock"></div>
  </div>

  <script>
    function createDigit(value) {
      const digit = document.createElement("div");
      digit.className = "digit";
      digit.innerHTML = `
        <div class="upper">${value}</div>
        <div class="lower">${value}</div>
        <div class="flip-upper">${value}</div>
        <div class="flip-lower">${value}</div>
      `;
      return digit;
    }

    function updateClock(initial=false) {
      const now = new Date();
      let h = now.getHours();
      const m = now.getMinutes().toString().padStart(2,'0');

      // 12시간제 + AM/PM
      const ampm = h >= 12 ? "PM" : "AM";
      h = (h % 12) || 12;
      const timeStr = h.toString().padStart(2,'0') + m;

      const clock = document.getElementById("clock");
      if (initial) {
        clock.innerHTML = "";
        for (let i=0; i<timeStr.length; i++) {
          clock.appendChild(createDigit(timeStr[i]));
        }
      } else {
        const digits = clock.querySelectorAll(".digit");
        timeStr.split("").forEach((num,i)=>{
          const digit = digits[i];
          const upper = digit.querySelector(".upper");
          const lower = digit.querySelector(".lower");
          const flipUpper = digit.querySelector(".flip-upper");
          const flipLower = digit.querySelector(".flip-lower");

          if (upper.textContent !== num) {
            flipUpper.textContent = upper.textContent;
            flipLower.textContent = num;
            digit.classList.add("flip");

            setTimeout(()=>{
              upper.textContent = num;
              lower.textContent = num;
              digit.classList.remove("flip");
            },500);
          }
        });
      }
    }

    updateClock(true);

    const now = new Date();
    const delay = (60-now.getSeconds())*1000;
    setTimeout(()=>{
      updateClock();
      setInterval(updateClock,60000);
    },delay);
  </script>
</body>
</html>
